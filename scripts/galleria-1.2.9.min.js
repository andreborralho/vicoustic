function jqplotToImg(e){newCanvas=document.createElement("canvas");newCanvas.width=jQuery("#"+e).width();newCanvas.height=jQuery("#"+e).height();var t=jQuery("#"+e).offset();jQuery("#"+e).children().each(function(){if(jQuery(this)[0].tagName.toLowerCase()=="div"){jQuery(this).children("canvas").each(function(){var e=jQuery(this).offset();newCanvas.getContext("2d").drawImage(this,e.left-t.left,e.top-t.top)});jQuery(this).children("div").each(function(){var e=jQuery(this).offset();var n=newCanvas.getContext("2d");n.font=jQuery(this).css("font-style")+" "+jQuery(this).css("font-size")+" "+jQuery(this).css("font-family");n.fillText(jQuery(this).html(),e.left-t.left,e.top-t.top+10)})}else if(jQuery(this)[0].tagName.toLowerCase()=="canvas"){var e=jQuery(this).offset();newCanvas.getContext("2d").drawImage(this,e.left-t.left,e.top-t.top)}});jQuery("#"+e).children(".jqplot-point-label").each(function(){var e=jQuery(this).offset();var n=newCanvas.getContext("2d");n.font=jQuery(this).css("font-style")+" "+jQuery(this).css("font-size")+" "+jQuery(this).css("font-family");n.fillText(jQuery(this).html(),e.left-t.left,e.top-t.top+10)});jQuery("#"+e+" *").children(".jqplot-table-legend-swatch").each(function(){var e=jQuery(this).offset();var n=newCanvas.getContext("2d");n.setFillColor(jQuery(this).css("background-color"));n.fillRect(e.left-t.left,e.top-t.top,15,15)});jQuery("#"+e+" *").children(".jqplot-table-legend td:last-child").each(function(){var e=jQuery(this).offset();var n=newCanvas.getContext("2d");n.font=jQuery(this).css("font-style")+" "+jQuery(this).css("font-size")+" "+jQuery(this).css("font-family");n.fillText(jQuery(this).html(),e.left-t.left,e.top-t.top+15)});displayVals()}function displayVals(){var e=newCanvas.toDataURL();var t=e.replace(/^data:image\/(png|jpg);base64,/,"");jQuery.ajax({url:panel_id+"?view=panel",type:"POST",data:{img_PDF:t},async:false});return 0}(function(e){var t,n=this,r=n.document,i=e(r),s=e(n),o=Array.prototype,u=1.29,a=true,f=3e4,l=false,c=navigator.userAgent.toLowerCase(),h=n.location.hash.replace(/#\//,""),p=function(){},d=function(){return false},v=function(){var e=3,n=r.createElement("div"),i=n.getElementsByTagName("i");do{n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->"}while(i[0]);return e>4?e:t}(),m=function(){return{html:r.documentElement,body:r.body,head:r.getElementsByTagName("head")[0],title:r.title}},g=n.parent!==n.self,y="data ready thumbnail loadstart loadfinish image play pause progress "+"fullscreen_enter fullscreen_exit idle_enter idle_exit rescale "+"lightbox_open lightbox_close lightbox_image",b=function(){var t=[];e.each(y.split(" "),function(e,n){t.push(n);if(/_/.test(n)){t.push(n.replace(/_/g,""))}});return t}(),w=function(t){var n;if(typeof t!=="object"){return t}e.each(t,function(r,i){if(/^[a-z]+_/.test(r)){n="";e.each(r.split("_"),function(e,t){n+=e>0?t.substr(0,1).toUpperCase()+t.substr(1):t});t[n]=i;delete t[r]}});return t},E=function(t){if(e.inArray(t,b)>-1){return Galleria[t.toUpperCase()]}return t},S={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&(?:amp;)?)*v(?:<[A-Z]+>)?=([0-9a-zA-Z\-\_]+))/i,embed:function(e){return"http://www.youtube.com/embed/"+e},getThumb:function(t,r,i){i=i||p;e.getJSON(n.location.protocol+"//gdata.youtube.com/feeds/api/videos/"+t+"?v=2&alt=json-in-script&callback=?",function(e){try{r(e.entry.media$group.media$thumbnail[0].url)}catch(t){i()}}).error(i)}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(e){return"http://player.vimeo.com/video/"+e},getThumb:function(t,n,r){r=r||p;e.getJSON("http://vimeo.com/api/v2/video/"+t+".json?callback=?",function(e){try{n(e[0].thumbnail_medium)}catch(t){r()}}).error(r)}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(e){return"http://www.dailymotion.com/embed/video/"+e},getThumb:function(t,n,r){r=r||p;e.getJSON("https://api.dailymotion.com/video/"+t+"?fields=thumbnail_medium_url&callback=?",function(e){try{n(e.thumbnail_medium_url)}catch(t){r()}}).error(r)}}},x=function(e){var t;for(var n in S){t=e&&e.match(S[n].reg);if(t&&t.length){return{id:t[2],provider:n}}}return false},T={support:function(){var e=m().html;return!g&&(e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen)}(),callback:p,enter:function(e,t,n){this.instance=e;this.callback=t||p;n=n||m().html;if(n.requestFullscreen){n.requestFullscreen()}else if(n.mozRequestFullScreen){n.mozRequestFullScreen()}else if(n.webkitRequestFullScreen){n.webkitRequestFullScreen()}},exit:function(e){this.callback=e||p;if(r.exitFullscreen){r.exitFullscreen()}else if(r.mozCancelFullScreen){r.mozCancelFullScreen()}else if(r.webkitCancelFullScreen){r.webkitCancelFullScreen()}},instance:null,listen:function(){if(!this.support){return}var e=function(){if(!T.instance){return}var e=T.instance._fullscreen;if(r.fullscreen||r.mozFullScreen||r.webkitIsFullScreen){e._enter(T.callback)}else{e._exit(T.callback)}};r.addEventListener("fullscreenchange",e,false);r.addEventListener("mozfullscreenchange",e,false);r.addEventListener("webkitfullscreenchange",e,false)}},N=[],C=[],k=false,L=false,A=[],O=function(t){Galleria.theme=t;e.each(A,function(e,t){if(!t._initialized){t._init.call(t)}});A=[]},M=function(){return{clearTimer:function(t){e.each(Galleria.get(),function(){this.clearTimer(t)})},addTimer:function(t){e.each(Galleria.get(),function(){this.addTimer(t)})},array:function(e){return o.slice.call(e,0)},create:function(e,t){t=t||"div";var n=r.createElement(t);n.className=e;return n},removeFromArray:function(t,n){e.each(t,function(e,r){if(r==n){t.splice(e,1);return false}});return t},getScriptPath:function(t){t=t||e("script:last").attr("src");var n=t.split("/");if(n.length==1){return""}n.pop();return n.join("/")+"/"},animate:function(){var t=function(e){var t="transition WebkitTransition MozTransition OTransition".split(" "),r;if(n.opera){return false}for(r=0;t[r];r++){if(typeof e[t[r]]!=="undefined"){return t[r]}}return false}((r.body||r.documentElement).style);var i={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[t];var s={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]};var o=function(t,n,r){var i={};r=r||"transition";e.each("webkit moz ms o".split(" "),function(){i["-"+this+"-"+r]=n});t.css(i)};var u=function(e){o(e,"none","transition");if(Galleria.WEBKIT&&Galleria.TOUCH){o(e,"translate3d(0,0,0)","transform");if(e.data("revert")){e.css(e.data("revert"));e.data("revert",null)}}};var a,f,l,c,h,d,v;return function(r,m,g){g=e.extend({duration:400,complete:p,stop:false},g);r=e(r);if(!g.duration){r.css(m);g.complete.call(r[0]);return}if(!t){r.animate(m,g);return}if(g.stop){r.unbind(i);u(r)}a=false;e.each(m,function(e,t){v=r.css(e);if(M.parseValue(v)!=M.parseValue(t)){a=true}r.css(e,v)});if(!a){n.setTimeout(function(){g.complete.call(r[0])},g.duration);return}f=[];l=g.easing in s?s[g.easing]:s._default;c=" "+g.duration+"ms"+" cubic-bezier("+l.join(",")+")";n.setTimeout(function(t,n,r,i){return function(){t.one(n,function(e){return function(){u(e);g.complete.call(e[0])}}(t));if(Galleria.WEBKIT&&Galleria.TOUCH){h={};d=[0,0,0];e.each(["left","top"],function(e,n){if(n in r){d[e]=M.parseValue(r[n])-M.parseValue(t.css(n))+"px";h[n]=r[n];delete r[n]}});if(d[0]||d[1]){t.data("revert",h);f.push("-webkit-transform"+i);o(t,"translate3d("+d.join(",")+")","transform")}}e.each(r,function(e,t){f.push(e+i)});o(t,f.join(","));t.css(r)}}(r,i,m,c),2)}}(),removeAlpha:function(e){if(v<9&&e){var t=e.style,n=e.currentStyle,r=n&&n.filter||t.filter||"";if(/alpha/.test(r)){t.filter=r.replace(/alpha\([^)]*\)/i,"")}}},forceStyles:function(t,n){t=e(t);if(t.attr("style")){t.data("styles",t.attr("style")).removeAttr("style")}t.css(n)},revertStyles:function(){e.each(M.array(arguments),function(t,n){n=e(n);n.removeAttr("style");n.attr("style","");if(n.data("styles")){n.attr("style",n.data("styles")).data("styles",null)}})},moveOut:function(e){M.forceStyles(e,{position:"absolute",left:-1e4})},moveIn:function(){M.revertStyles.apply(M,M.array(arguments))},elem:function(t){if(t instanceof e){return{$:t,dom:t[0]}}else{return{$:e(t),dom:t}}},hide:function(e,t,n){n=n||p;var r=M.elem(e),i=r.$;e=r.dom;if(!i.data("opacity")){i.data("opacity",i.css("opacity"))}var s={opacity:0};if(t){var o=v<9&&e?function(){M.removeAlpha(e);e.style.visibility="hidden";n.call(e)}:n;M.animate(e,s,{duration:t,complete:o,stop:true})}else{if(v<9&&e){M.removeAlpha(e);e.style.visibility="hidden"}else{i.css(s)}}},show:function(e,t,n){n=n||p;var r=M.elem(e),i=r.$;e=r.dom;var s=parseFloat(i.data("opacity"))||1,o={opacity:s};if(t){if(v<9){i.css("opacity",0);e.style.visibility="visible"}var u=v<9&&e?function(){if(o.opacity==1){M.removeAlpha(e)}n.call(e)}:n;M.animate(e,o,{duration:t,complete:u,stop:true})}else{if(v<9&&o.opacity==1&&e){M.removeAlpha(e);e.style.visibility="visible"}else{i.css(o)}}},optimizeTouch:function(){var t,n,r,i,s={},o=function(t){t.preventDefault();s=e.extend({},t,true)},u=function(){this.evt=s},a=function(){this.handler.call(t,this.evt)};return function(s){e(s).bind("touchend",function(s){t=s.target;i=true;while(t.parentNode&&t!=s.currentTarget&&i){n=e(t).data("events");r=e(t).data("fakes");if(n&&"click"in n){i=false;s.preventDefault();e(t).click(o).click();n.click.pop();e.each(n.click,u);e(t).data("fakes",n.click);delete n.click}else if(r){i=false;s.preventDefault();e.each(r,a)}t=t.parentNode}})}}(),wait:function(t){t=e.extend({until:d,success:p,error:function(){Galleria.raise("Could not complete wait function.")},timeout:3e3},t);var r=M.timestamp(),i,s,o=function(){s=M.timestamp();i=s-r;if(t.until(i)){t.success();return false}if(typeof t.timeout=="number"&&s>=r+t.timeout){t.error();return false}n.setTimeout(o,10)};n.setTimeout(o,10)},toggleQuality:function(e,t){if(v!==7&&v!==8||!e||e.nodeName.toUpperCase()!="IMG"){return}if(typeof t==="undefined"){t=e.style.msInterpolationMode==="nearest-neighbor"}e.style.msInterpolationMode=t?"bicubic":"nearest-neighbor"},insertStyleTag:function(t,n){if(n&&e("#"+n).length){return}var i=r.createElement("style");if(n){i.id=n}m().head.appendChild(i);if(i.styleSheet){i.styleSheet.cssText=t}else{var s=r.createTextNode(t);i.appendChild(s)}},loadScript:function(t,n){var r=false,i=e("<scr"+"ipt>").attr({src:t,async:true}).get(0);i.onload=i.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){r=true;i.onload=i.onreadystatechange=null;if(typeof n==="function"){n.call(this,this)}}};m().head.appendChild(i)},parseValue:function(e){if(typeof e==="number"){return e}else if(typeof e==="string"){var t=e.match(/\-?\d|\./g);return t&&t.constructor===Array?t.join("")*1:0}else{return 0}},timestamp:function(){return(new Date).getTime()},loadCSS:function(n,i,s){var o,u;e("link[rel=stylesheet]").each(function(){if((new RegExp(n)).test(this.href)){o=this;return false}});if(typeof i==="function"){s=i;i=t}s=s||p;if(o){s.call(o,o);return o}u=r.styleSheets.length;if(e("#"+i).length){e("#"+i).attr("href",n);u--}else{o=e("<link>").attr({rel:"stylesheet",href:n,id:i}).get(0);var a=e('link[rel="stylesheet"], style');if(a.length){a.get(0).parentNode.insertBefore(o,a[0])}else{m().head.appendChild(o)}if(v){if(u>=31){Galleria.raise("You have reached the browser stylesheet limit (31)",true);return}}}if(typeof s==="function"){var f=e("<s>").attr("id","galleria-loader").hide().appendTo(m().body);M.wait({until:function(){return f.height()==1},success:function(){f.remove();s.call(o,o)},error:function(){f.remove();Galleria.raise("Theme CSS could not load after 20 sec. "+(Galleria.QUIRK?"Your browser is in Quirks Mode, please add a correct doctype.":"Please download the latest theme at http://galleria.io/customer/."),true)},timeout:5e3})}return o}}}(),_=function(){var t=function(t,n,r,i){var s=this.getOptions("easing"),o=this.getStageWidth(),u={left:o*(t.rewind?-1:1)},a={left:0};if(r){u.opacity=0;a.opacity=1}else{u.opacity=1}e(t.next).css(u);M.animate(t.next,a,{duration:t.speed,complete:function(e){return function(){n();e.css({left:0})}}(e(t.next).add(t.prev)),queue:false,easing:s});if(i){t.rewind=!t.rewind}if(t.prev){u={left:0};a={left:o*(t.rewind?1:-1)};if(r){u.opacity=1;a.opacity=0}e(t.prev).css(u);M.animate(t.prev,a,{duration:t.speed,queue:false,easing:s,complete:function(){e(this).css("opacity",0)}})}};return{active:false,init:function(e,t,n){if(_.effects.hasOwnProperty(e)){_.effects[e].call(this,t,n)}},effects:{fade:function(t,n){e(t.next).css({opacity:0,left:0});M.animate(t.next,{opacity:1},{duration:t.speed,complete:n});if(t.prev){e(t.prev).css("opacity",1).show();M.animate(t.prev,{opacity:0},{duration:t.speed})}},flash:function(t,n){e(t.next).css({opacity:0,left:0});if(t.prev){M.animate(t.prev,{opacity:0},{duration:t.speed/2,complete:function(){M.animate(t.next,{opacity:1},{duration:t.speed,complete:n})}})}else{M.animate(t.next,{opacity:1},{duration:t.speed,complete:n})}},pulse:function(t,n){if(t.prev){e(t.prev).hide()}e(t.next).css({opacity:0,left:0}).show();M.animate(t.next,{opacity:1},{duration:t.speed,complete:n})},slide:function(e,n){t.apply(this,M.array(arguments))},fadeslide:function(e,n){t.apply(this,M.array(arguments).concat([true]))},doorslide:function(e,n){t.apply(this,M.array(arguments).concat([false,true]))}}}}();T.listen();Galleria=function(){var o=this;this._options={};this._playing=false;this._playtime=5e3;this._active=null;this._queue={length:0};this._data=[];this._dom={};this._thumbnails=[];this._layers=[];this._initialized=false;this._firstrun=false;this._stageWidth=0;this._stageHeight=0;this._target=t;this._binds=[];this._id=parseInt(Math.random()*1e4,10);var u="container stage images image-nav image-nav-left image-nav-right "+"info info-text info-title info-description "+"thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right "+"loader counter tooltip",a="current total";e.each(u.split(" "),function(e,t){o._dom[t]=M.create("galleria-"+t)});e.each(a.split(" "),function(e,t){o._dom[t]=M.create("galleria-"+t,"span")});var f=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:false,press:function(e){var t=e.keyCode||e.which;if(t in f.map&&typeof f.map[t]==="function"){f.map[t].call(o,e)}},attach:function(e){var t,n;for(t in e){if(e.hasOwnProperty(t)){n=t.toUpperCase();if(n in f.keys){f.map[f.keys[n]]=e[t]}else{f.map[n]=e[t]}}}if(!f.bound){f.bound=true;i.bind("keydown",f.press)}},detach:function(){f.bound=false;f.map={};i.unbind("keydown",f.press)}};var l=this._controls={0:t,1:t,active:0,swap:function(){l.active=l.active?0:1},getActive:function(){return l[l.active]},getNext:function(){return l[1-l.active]}};var h=this._carousel={next:o.$("thumb-nav-right"),prev:o.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var t=0,n=0,r=[0];e.each(o._thumbnails,function(i,s){if(s.ready){t+=s.outerWidth||e(s.container).outerWidth(true);r[i+1]=t;n=Math.max(n,s.outerHeight||e(s.container).outerHeight(true))}});o.$("thumbnails").css({width:t,height:n});h.max=t;h.hooks=r;h.width=o.$("thumbnails-list").width();h.setClasses();o.$("thumbnails-container").toggleClass("galleria-carousel",t>h.width);h.width=o.$("thumbnails-list").width()},bindControls:function(){var e;h.next.bind("click",function(t){t.preventDefault();if(o._options.carouselSteps==="auto"){for(e=h.current;e<h.hooks.length;e++){if(h.hooks[e]-h.hooks[h.current]>h.width){h.set(e-2);break}}}else{h.set(h.current+o._options.carouselSteps)}});h.prev.bind("click",function(t){t.preventDefault();if(o._options.carouselSteps==="auto"){for(e=h.current;e>=0;e--){if(h.hooks[h.current]-h.hooks[e]>h.width){h.set(e+2);break}else if(e===0){h.set(0);break}}}else{h.set(h.current-o._options.carouselSteps)}})},set:function(e){e=Math.max(e,0);while(h.hooks[e-1]+h.width>=h.max&&e>=0){e--}h.current=e;h.animate()},getLast:function(e){return(e||h.current)-1},follow:function(e){if(e===0||e===h.hooks.length-2){h.set(e);return}var t=h.current;while(h.hooks[t]-h.hooks[h.current]<h.width&&t<=h.hooks.length){t++}if(e-1<h.current){h.set(e-1)}else if(e+2>t){h.set(e-t+h.current+2)}},setClasses:function(){h.prev.toggleClass("disabled",!h.current);h.next.toggleClass("disabled",h.hooks[h.current]+h.width>=h.max)},animate:function(e){h.setClasses();var t=h.hooks[h.current]*-1;if(isNaN(t)){return}M.animate(o.get("thumbnails"),{left:t},{duration:o._options.carouselSpeed,easing:o._options.easing,queue:false})}};var p=this._tooltip={initialized:false,open:false,timer:"tooltip"+o._id,swapTimer:"swap"+o._id,init:function(){p.initialized=true;var e=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3;"+"opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";M.insertStyleTag(e,"galleria-tooltip");o.$("tooltip").css({opacity:.8,visibility:"visible",display:"none"})},move:function(e){var t=o.getMousePosition(e).x,n=o.getMousePosition(e).y,r=o.$("tooltip"),i=t,s=n,u=r.outerHeight(true)+1,a=r.outerWidth(true),f=u+15;var l=o.$("container").width()-a-2,c=o.$("container").height()-u-2;if(!isNaN(i)&&!isNaN(s)){i+=10;s-=u+8;i=Math.max(0,Math.min(l,i));s=Math.max(0,Math.min(c,s));if(n<f){s=f}r.css({left:i,top:s})}},bind:function(t,n){if(Galleria.TOUCH){return}if(!p.initialized){p.init()}var r=function(){o.$("container").unbind("mousemove",p.move);o.clearTimer(p.timer);o.$("tooltip").stop().animate({opacity:0},200,function(){o.$("tooltip").hide();o.addTimer(p.swapTimer,function(){p.open=false},1e3)})};var i=function(t,n){p.define(t,n);e(t).hover(function(){o.clearTimer(p.swapTimer);o.$("container").unbind("mousemove",p.move).bind("mousemove",p.move).trigger("mousemove");p.show(t);o.addTimer(p.timer,function(){o.$("tooltip").stop().show().animate({opacity:1});p.open=true},p.open?0:500)},r).click(r)};if(typeof n==="string"){i(t in o._dom?o.get(t):t,n)}else{e.each(t,function(e,t){i(o.get(e),t)})}},show:function(t){t=e(t in o._dom?o.get(t):t);var r=t.data("tt"),i=function(e){n.setTimeout(function(e){return function(){p.move(e)}}(e),10);t.unbind("mouseup",i)};r=typeof r==="function"?r():r;if(!r){return}o.$("tooltip").html(r.replace(/\s/,"&#160;"));t.bind("mouseup",i)},define:function(t,n){if(typeof n!=="function"){var r=n;n=function(){return r}}t=e(t in o._dom?o.get(t):t).data("tt",n);p.show(t)}};var d=this._fullscreen={scrolled:0,crop:t,active:false,keymap:o._keyboard.map,parseCallback:function(t,n){return _.active?function(){if(typeof t=="function"){t.call(o)}var r=o._controls.getActive(),i=o._controls.getNext();o._scaleImage(i);o._scaleImage(r);if(n&&o._options.trueFullscreen){e(r.container).add(i.container).trigger("transitionend")}}:t},enter:function(e){e=d.parseCallback(e,true);if(o._options.trueFullscreen&&T.support){d.active=true;M.forceStyles(o.get("container"),{width:"100%",height:"100%"});o.rescale();if(Galleria.MAC){if(Galleria.WEBKIT&&!(Galleria.SAFARI&&/version\/[1-5]/.test(c))){o.$("container").css("opacity",0).addClass("fullscreen");n.setTimeout(function(){d.scale();o.$("container").css("opacity",1)},50)}else{o.$("stage").css("opacity",0);n.setTimeout(function(){d.scale();o.$("stage").css("opacity",1)},4)}}else{o.$("container").addClass("fullscreen")}s.resize(d.scale);T.enter(o,e,o.get("container"))}else{d.scrolled=s.scrollTop();n.scrollTo(0,0);d._enter(e)}},_enter:function(i){d.active=true;if(g){d.iframe=function(){var t,i=r.referrer,s=r.createElement("a"),o=n.location;s.href=i;if(s.protocol!=o.protocol||s.hostname!=o.hostname||s.port!=o.port){Galleria.raise("Parent fullscreen not available. Iframe protocol, domains and ports must match.");return false}d.pd=n.parent.document;e(d.pd).find("iframe").each(function(){var e=this.contentDocument||this.contentWindow.document;if(e===r){t=this;return false}});return t}()}M.hide(o.getActiveImage());if(g&&d.iframe){d.iframe.scrolled=e(n.parent).scrollTop();n.parent.scrollTo(0,0)}var u=o.getData(),a=o._options,f=!o._options.trueFullscreen||!T.support,l={height:"100%",overflow:"hidden",margin:0,padding:0};if(f){o.$("container").addClass("fullscreen");M.forceStyles(o.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});M.forceStyles(m().html,l);M.forceStyles(m().body,l)}if(g&&d.iframe){M.forceStyles(d.pd.documentElement,l);M.forceStyles(d.pd.body,l);M.forceStyles(d.iframe,e.extend(l,{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:1e4,border:"none"}))}d.keymap=e.extend({},o._keyboard.map);o.attachKeyboard({escape:o.exitFullscreen,right:o.next,left:o.prev});d.crop=a.imageCrop;if(a.fullscreenCrop!=t){a.imageCrop=a.fullscreenCrop}if(u&&u.big&&u.image!==u.big){var c=new Galleria.Picture,h=c.isCached(u.big),p=o.getIndex(),v=o._thumbnails[p];o.trigger({type:Galleria.LOADSTART,cached:h,rewind:false,index:p,imageTarget:o.getActiveImage(),thumbTarget:v,galleriaData:u});c.load(u.big,function(t){o._scaleImage(t,{complete:function(t){o.trigger({type:Galleria.LOADFINISH,cached:h,index:p,rewind:false,imageTarget:t.image,thumbTarget:v});var n=o._controls.getActive().image;if(n){e(n).width(t.image.width).height(t.image.height).attr("style",e(t.image).attr("style")).attr("src",t.image.src)}}})})}o.rescale(function(){o.addTimer(false,function(){if(f){M.show(o.getActiveImage())}if(typeof i==="function"){i.call(o)}},100);o.trigger(Galleria.FULLSCREEN_ENTER)});if(!f){M.show(o.getActiveImage())}else{s.resize(d.scale)}},scale:function(){o.rescale()},exit:function(e){e=d.parseCallback(e);if(o._options.trueFullscreen&&T.support){T.exit(e)}else{d._exit(e)}},_exit:function(e){d.active=false;var t=!o._options.trueFullscreen||!T.support;o.$("container").removeClass("fullscreen");if(t){M.hide(o.getActiveImage());M.revertStyles(o.get("container"),m().html,m().body);n.scrollTo(0,d.scrolled)}if(g&&d.iframe){M.revertStyles(d.pd.documentElement,d.pd.body,d.iframe);if(d.iframe.scrolled){n.parent.scrollTo(0,d.iframe.scrolled)}}o.detachKeyboard();o.attachKeyboard(d.keymap);o._options.imageCrop=d.crop;var r=o.getData().big,i=o._controls.getActive().image;if(!o.getData().iframe&&i&&r&&r==i.src){n.setTimeout(function(e){return function(){i.src=e}}(o.getData().image),1)}o.rescale(function(){o.addTimer(false,function(){if(t){M.show(o.getActiveImage())}if(typeof e==="function"){e.call(o)}s.trigger("resize")},50);o.trigger(Galleria.FULLSCREEN_EXIT)});s.unbind("resize",d.scale)}};var y=this._idle={trunk:[],bound:false,active:false,add:function(t,n,r,i){if(!t){return}if(!y.bound){y.addEvent()}t=e(t);if(typeof r=="boolean"){i=r;r={}}r=r||{};var s={},o;for(o in n){if(n.hasOwnProperty(o)){s[o]=t.css(o)}}t.data("idle",{from:e.extend(s,r),to:n,complete:true,busy:false});if(!i){y.addTimer()}else{t.css(n)}y.trunk.push(t)},remove:function(t){t=e(t);e.each(y.trunk,function(e,n){if(n&&n.length&&!n.not(t).length){t.css(t.data("idle").from);y.trunk.splice(e,1)}});if(!y.trunk.length){y.removeEvent();o.clearTimer(y.timer)}},addEvent:function(){y.bound=true;o.$("container").bind("mousemove click",y.showAll);if(o._options.idleMode=="hover"){o.$("container").bind("mouseleave",y.hide)}},removeEvent:function(){y.bound=false;o.$("container").bind("mousemove click",y.showAll);if(o._options.idleMode=="hover"){o.$("container").unbind("mouseleave",y.hide)}},addTimer:function(){if(o._options.idleMode=="hover"){return}o.addTimer("idle",function(){y.hide()},o._options.idleTime)},hide:function(){if(!o._options.idleMode||o.getIndex()===false||o.getData().iframe){return}o.trigger(Galleria.IDLE_ENTER);var t=y.trunk.length;e.each(y.trunk,function(e,n){var r=n.data("idle");if(!r){return}n.data("idle").complete=false;M.animate(n,r.to,{duration:o._options.idleSpeed,complete:function(){if(e==t-1){y.active=false}}})})},showAll:function(){o.clearTimer("idle");e.each(y.trunk,function(e,t){y.show(t)})},show:function(t){var n=t.data("idle");if(!y.active||!n.busy&&!n.complete){n.busy=true;o.trigger(Galleria.IDLE_EXIT);o.clearTimer("idle");M.animate(t,n.from,{duration:o._options.idleSpeed/2,complete:function(){y.active=true;e(t).data("idle").busy=false;e(t).data("idle").complete=true}})}y.addTimer()}};var b=this._lightbox={width:0,height:0,initialized:false,active:null,image:null,elems:{},keymap:false,init:function(){o.trigger(Galleria.LIGHTBOX_OPEN);if(b.initialized){return}b.initialized=true;var t="overlay box content shadow title info close prevholder prev nextholder next counter image",n={},r=o._options,i="",s="position:absolute;",u="lightbox-",a={overlay:"position:fixed;display:none;opacity:"+r.overlayOpacity+";filter:alpha(opacity="+r.overlayOpacity*100+");top:0;left:0;width:100%;height:100%;background:"+r.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:s+"background:#000;width:100%;height:100%;",content:s+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:s+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:s+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:s+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:s+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:s+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:s+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:s+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},f=function(t){return t.hover(function(){e(this).css("color","#bbb")},function(){e(this).css("color","#444")})},l={};if(v&&v>7){a.nextholder+="background:#000;filter:alpha(opacity=0);";a.prevholder+="background:#000;filter:alpha(opacity=0);"}e.each(a,function(e,t){i+=".galleria-"+u+e+"{"+t+"}"});i+=".galleria-"+u+"box.iframe .galleria-"+u+"prevholder,"+".galleria-"+u+"box.iframe .galleria-"+u+"nextholder{"+"width:100px;height:100px;top:50%;margin-top:-70px}";M.insertStyleTag(i,"galleria-lightbox");e.each(t.split(" "),function(e,t){o.addElement("lightbox-"+t);n[t]=b.elems[t]=o.get("lightbox-"+t)});b.image=new Galleria.Picture;e.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(t,n){var r=[];e.each(n.split(" "),function(e,t){r.push(u+t)});l[u+t]=r});o.append(l);e(n.image).append(b.image.container);e(m().body).append(n.overlay,n.box);M.optimizeTouch(n.box);f(e(n.close).bind("click",b.hide).html("&#215;"));e.each(["Prev","Next"],function(t,r){var i=e(n[r.toLowerCase()]).html(/v/.test(r)?"&#8249;&#160;":"&#160;&#8250;"),s=e(n[r.toLowerCase()+"holder"]);s.bind("click",function(){b["show"+r]()});if(v<8||Galleria.TOUCH){i.show();return}s.hover(function(){i.show()},function(e){i.stop().fadeOut(200)})});e(n.overlay).bind("click",b.hide);if(Galleria.IPAD){o._options.lightboxTransitionSpeed=0}},rescale:function(t){var n=Math.min(s.width()-40,b.width),r=Math.min(s.height()-60,b.height),i=Math.min(n/b.width,r/b.height),u=Math.round(b.width*i)+40,a=Math.round(b.height*i)+60,f={width:u,height:a,"margin-top":Math.ceil(a/2)*-1,"margin-left":Math.ceil(u/2)*-1};if(t){e(b.elems.box).css(f)}else{e(b.elems.box).animate(f,{duration:o._options.lightboxTransitionSpeed,easing:o._options.easing,complete:function(){var t=b.image,n=o._options.lightboxFadeSpeed;o.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:t.image});e(t.container).show();e(t.image).animate({opacity:1},n);M.show(b.elems.info,n)}})}},hide:function(){b.image.image=null;s.unbind("resize",b.rescale);e(b.elems.box).hide();M.hide(b.elems.info);o.detachKeyboard();o.attachKeyboard(b.keymap);b.keymap=false;M.hide(b.elems.overlay,200,function(){e(this).hide().css("opacity",o._options.overlayOpacity);o.trigger(Galleria.LIGHTBOX_CLOSE)})},showNext:function(){b.show(o.getNext(b.active))},showPrev:function(){b.show(o.getPrev(b.active))},show:function(t){b.active=t=typeof t==="number"?t:o.getIndex()||0;if(!b.initialized){b.init()}if(!b.keymap){b.keymap=e.extend({},o._keyboard.map);o.attachKeyboard({escape:b.hide,right:b.showNext,left:b.showPrev})}s.unbind("resize",b.rescale);var r=o.getData(t),i=o.getDataLength(),u=o.getNext(t),a,f,l;M.hide(b.elems.info);try{for(l=o._options.preload;l>0;l--){f=new Galleria.Picture;a=o.getData(u);f.preload("big"in a?a.big:a.image);u=o.getNext(u)}}catch(c){}b.image.isIframe=!!r.iframe;e(b.elems.box).toggleClass("iframe",!!r.iframe);b.image.load(r.iframe||r.big||r.image,function(u){if(u.isIframe){var a=e(n).width(),f=e(n).height();if(o._options.maxVideoSize){var l=Math.min(o._options.maxVideoSize/a,o._options.maxVideoSize/f);if(l<1){a*=l;f*=l}}b.width=a;b.height=f}else{b.width=u.original.width;b.height=u.original.height}e(u.image).css({width:u.isIframe?"100%":"100.1%",height:u.isIframe?"100%":"100.1%",top:0,zIndex:99998,opacity:0,visibility:"visible"});b.elems.title.innerHTML=r.title||"";b.elems.counter.innerHTML=t+1+" / "+i;s.resize(b.rescale);b.rescale()});e(b.elems.overlay).show().css("visibility","visible");e(b.elems.box).show()}};var w=this._timer={trunk:{},add:function(e,t,r,i){e=e||(new Date).getTime();i=i||false;this.clear(e);if(i){var s=t;t=function(){s();w.add(e,t,r)}}this.trunk[e]=n.setTimeout(t,r)},clear:function(e){var t=function(e){n.clearTimeout(this.trunk[e]);delete this.trunk[e]},r;if(!!e&&e in this.trunk){t.call(this,e)}else if(typeof e==="undefined"){for(r in this.trunk){if(this.trunk.hasOwnProperty(r)){t.call(this,r)}}}}};return this};Galleria.prototype={constructor:Galleria,init:function(n,r){var i=this;r=w(r);this._original={target:n,options:r,data:null};this._target=this._dom.target=n.nodeName?n:e(n).get(0);this._original.html=this._target.innerHTML;C.push(this);if(!this._target){Galleria.raise("Target not found",true);return}this._options={autoplay:false,carousel:true,carouselFollow:true,carouselSpeed:400,carouselSteps:"auto",clicknext:false,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(e){return{}},dataSelector:"img",dataSort:false,dataSource:this._target,debug:t,dummy:t,easing:"galleria",extend:function(e){},fullscreenCrop:t,fullscreenDoubleTap:true,fullscreenTransition:t,height:0,idleMode:true,idleTime:3e3,idleSpeed:200,imageCrop:false,imageMargin:0,imagePan:false,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:t,initialTransition:t,keepSource:false,layerFollow:true,lightbox:false,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:true,maxScaleRatio:t,maxVideoSize:t,minScaleRatio:t,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:true,popupLinks:false,preload:2,queue:true,responsive:true,show:0,showInfo:true,showCounter:true,showImagenav:true,swipe:true,thumbCrop:true,thumbEventType:"click",thumbFit:true,thumbMargin:0,thumbQuality:"auto",thumbDisplayOrder:true,thumbnails:true,touchTransition:t,transition:"fade",transitionInitial:t,transitionSpeed:400,trueFullscreen:true,useCanvas:false,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}};this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial;if(r&&r.debug===false){a=false}if(r&&typeof r.imageTimeout==="number"){f=r.imageTimeout}if(r&&typeof r.dummy==="string"){l=r.dummy}e(this._target).children().hide();if(Galleria.QUIRK){Galleria.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML and add a correct doctype.")}if(typeof Galleria.theme==="object"){this._init()}else{A.push(this)}return this},_init:function(){var t=this,i=this._options;if(this._initialized){Galleria.raise("Init failed: Gallery instance already initialized.");return this}this._initialized=true;if(!Galleria.theme){Galleria.raise("Init failed: No theme found.",true);return this}e.extend(true,i,Galleria.theme.defaults,this._original.options,Galleria.configure.options);(function(e){if(!("getContext"in e)){e=null;return}L=L||{elem:e,context:e.getContext("2d"),cache:{},length:0}})(r.createElement("canvas"));this.bind(Galleria.DATA,function(){this._original.data=this._data;this.get("total").innerHTML=this.getDataLength();var e=this.$("container");if(t._options.height<2){t._userRatio=t._ratio=t._options.height}var r={width:0,height:0};var i=function(){return t.$("stage").height()};M.wait({until:function(){r=t._getWH();e.width(r.width).height(r.height);return i()&&r.width&&r.height>50},success:function(){t._width=r.width;t._height=r.height;t._ratio=t._ratio||r.height/r.width;if(Galleria.WEBKIT){n.setTimeout(function(){t._run()},1)}else{t._run()}},error:function(){if(i()){Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+r.width+"px, height: "+r.height+"px.",true)}else{Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+i()+"px.",true)}},timeout:typeof this._options.wait=="number"?this._options.wait:false})});this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]});M.hide(this.$("counter").append(this.get("current"),r.createTextNode(" / "),this.get("total")));this.setCounter("&#8211;");M.hide(t.get("tooltip"));this.$("container").addClass(Galleria.TOUCH?"touch":"notouch");e.each(new Array(2),function(n){var r=new Galleria.Picture;e(r.container).css({position:"absolute",top:0,left:0}).prepend(t._layers[n]=e(M.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]);t.$("images").append(r.container);t._controls[n]=r});this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"});this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"});this.$("image-nav-right, image-nav-left").bind("click",function(e){if(i.clicknext){e.stopPropagation()}if(i.pauseOnInteraction){t.pause()}var n=/right/.test(this.className)?"next":"prev";t[n]()});e.each(["info","counter","image-nav"],function(e,n){if(i["show"+n.substr(0,1).toUpperCase()+n.substr(1).replace(/-/,"")]===false){M.moveOut(t.get(n.toLowerCase()))}});this.load();if(!i.keepSource&&!v){this._target.innerHTML=""}if(this.get("errors")){this.appendChild("target","errors")}this.appendChild("target","container");if(i.carousel){var o=0,u=i.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel();if(++o==this.getDataLength()&&typeof u=="number"&&u>0){this._carousel.follow(u)}})}if(i.responsive){s.bind("resize",function(){if(!t.isFullscreen()){t.resize()}})}if(i.swipe){(function(e){var n=[0,0],r=[0,0],i=30,s=100,o=false,u=0,a,f={start:"touchstart",move:"touchmove",stop:"touchend"},l=function(e){return e.originalEvent.touches?e.originalEvent.touches[0]:e},c=function(e){if(e.originalEvent.touches&&e.originalEvent.touches.length>1){return}a=l(e);r=[a.pageX,a.pageY];if(!n[0]){n=r}if(Math.abs(n[0]-r[0])>10){e.preventDefault()}},h=function(a){e.unbind(f.move,c);if(a.originalEvent.touches&&a.originalEvent.touches.length||o){o=!o;return}if(M.timestamp()-u<1e3&&Math.abs(n[0]-r[0])>i&&Math.abs(n[1]-r[1])<s){a.preventDefault();t[n[0]>r[0]?"next":"prev"]()}n=r=[0,0]};e.bind(f.start,function(t){if(t.originalEvent.touches&&t.originalEvent.touches.length>1){return}a=l(t);u=M.timestamp();n=r=[a.pageX,a.pageY];e.bind(f.move,c).one(f.stop,h)})})(t.$("images"));if(i.fullscreenDoubleTap){this.$("stage").bind("touchstart",function(){var e,n,r,i,s,o,u=function(e){return e.originalEvent.touches?e.originalEvent.touches[0]:e};return function(a){o=Galleria.utils.timestamp();n=u(a).pageX;r=u(a).pageY;if(o-e<500&&n-i<20&&r-s<20){t.toggleFullscreen();a.preventDefault();t.$("stage").unbind("touchend",arguments.callee);return}e=o;i=n;s=r}}())}}M.optimizeTouch(this.get("container"));e.each(Galleria.on.binds,function(n,r){if(e.inArray(r.hash,t._binds)==-1){t.bind(r.type,r.callback)}});return this},addTimer:function(){this._timer.add.apply(this._timer,M.array(arguments));return this},clearTimer:function(){this._timer.clear.apply(this._timer,M.array(arguments));return this},_getWH:function(){var t=this.$("container"),n=this.$("target"),r=this,i={},s;e.each(["width","height"],function(e,o){if(r._options[o]&&typeof r._options[o]==="number"){i[o]=r._options[o]}else{s=[M.parseValue(t.css(o)),M.parseValue(n.css(o)),t[o](),n[o]()];if(!r["_"+o]){s.splice(s.length,M.parseValue(t.css("min-"+o)),M.parseValue(n.css("min-"+o)))}i[o]=Math.max.apply(Math,s)}});if(r._userRatio){i.height=i.width*r._userRatio}return i},_createThumbnails:function(t){this.get("total").innerHTML=this.getDataLength();var i,s,o,u,a,f=this,l=this._options,c=t?this._data.length-t.length:0,h=c,p=[],d=0,m=v<8?"http://upload.wikimedia.org/wikipedia/commons/c/c0/Blank.gif":"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",g=function(){var e=f.$("thumbnails").find(".active");if(!e.length){return false}return e.find("img").attr("src")}(),y=typeof l.thumbnails==="string"?l.thumbnails.toLowerCase():null,b=function(e){return r.defaultView&&r.defaultView.getComputedStyle?r.defaultView.getComputedStyle(s.container,null)[e]:a.css(e)},w=function(t,n,r){return function(){e(r).append(t);f.trigger({type:Galleria.THUMBNAIL,thumbTarget:t,index:n,galleriaData:f.getData(n)})}},E=function(t){if(l.pauseOnInteraction){f.pause()}var n=e(t.currentTarget).data("index");if(f.getIndex()!==n){f.show(n)}t.preventDefault()},x=function(t,n){e(t.container).css("visibility","visible");f.trigger({type:Galleria.THUMBNAIL,thumbTarget:t.image,index:t.data.order,galleriaData:f.getData(t.data.order)});if(typeof n=="function"){n.call(f,t)}},T=function(t,n){t.scale({width:t.data.width,height:t.data.height,crop:l.thumbCrop,margin:l.thumbMargin,canvas:l.useCanvas,complete:function(t){var r=["left","top"],i=["Width","Height"],s,o,u=f.getData(t.index),a=u.thumb.split(":");e.each(i,function(n,i){s=i.toLowerCase();if((l.thumbCrop!==true||l.thumbCrop===s)&&l.thumbFit){o={};o[s]=t[s];e(t.container).css(o);o={};o[r[n]]=0;e(t.image).css(o)}t["outer"+i]=e(t.container)["outer"+i](true)});M.toggleQuality(t.image,l.thumbQuality===true||l.thumbQuality==="auto"&&t.original.width<t.width*3);if(u.iframe&&a.length==2&&a[0]in S){S[a[0]].getThumb(a[1],function(e){return function(r){e.src=r;x(t,n)}}(t.image))}else if(l.thumbDisplayOrder&&!t.lazy){e.each(p,function(e,t){if(e===d&&t.ready&&!t.displayed){d++;t.displayed=true;x(t,n);return}})}else{x(t,n)}}})};if(!t){this._thumbnails=[];this.$("thumbnails").empty()}for(;this._data[c];c++){o=this._data[c];i=o.thumb||o.image;if((l.thumbnails===true||y=="lazy")&&(o.thumb||o.image)){s=new Galleria.Picture(c);s.index=c;s.displayed=false;s.lazy=false;s.video=false;this.$("thumbnails").append(s.container);a=e(s.container);a.css("visibility","hidden");s.data={width:M.parseValue(b("width")),height:M.parseValue(b("height")),order:c,src:i};if(l.thumbFit&&l.thumbCrop!==true){a.css({width:"auto",height:"auto"})}else{a.css({width:s.data.width,height:s.data.height})}u=i.split(":");if(u.length==2&&u[0]in S){s.video=true;s.ready=true;s.load(m,{height:s.data.height,width:s.data.height*1.25},T)}else if(y=="lazy"){a.addClass("lazy");s.lazy=true;s.load(m,{height:s.data.height,width:s.data.width})}else{s.load(i,T)}if(l.preload==="all"){s.preload(o.image)}}else if(o.iframe||y==="empty"||y==="numbers"){s={container:M.create("galleria-image"),image:M.create("img","span"),ready:true};if(y==="numbers"){e(s.image).text(c+1)}if(o.iframe){e(s.image).addClass("iframe")}this.$("thumbnails").append(s.container);n.setTimeout(w(s.image,c,s.container),50+c*20)}else{s={container:null,image:null}}e(s.container).add(l.keepSource&&l.linkSourceImages?o.original:null).data("index",c).bind(l.thumbEventType,E).data("thumbload",T);if(g===i){e(s.container).addClass("active")}this._thumbnails.push(s)}p=this._thumbnails.slice(h);return this},lazyLoad:function(t,n){var r=t.constructor==Array?t:[t],i=this,s=this.$("thumbnails").children().filter(function(){return e(this).data("lazy-src")}),o=0;e.each(r,function(t,s){if(s>i._thumbnails.length-1){return}var u=i._thumbnails[s],a=u.data,f=a.src.split(":"),l=function(){if(++o==r.length&&typeof n=="function"){n.call(i)}},c=e(u.container).data("thumbload");if(u.video){c.call(i,u,l)}else{u.load(a.src,function(e){c.call(i,e,l)})}});return this},lazyLoadChunks:function(e,t){var r=this.getDataLength(),i=0,s=0,o=[],u=[],a=this;t=t||0;for(;i<r;i++){u.push(i);if(++s==e||i==r-1){o.push(u);s=0;u=[]}}var f=function(e){var r=o.shift();if(r){n.setTimeout(function(){a.lazyLoad(r,function(){f(true)})},t&&e?t:0)}};f(false);return this},_run:function(){var r=this;r._createThumbnails();M.wait({timeout:1e4,until:function(){if(Galleria.OPERA){r.$("stage").css("display","inline-block")}r._stageWidth=r.$("stage").width();r._stageHeight=r.$("stage").height();return r._stageWidth&&r._stageHeight>50},success:function(){N.push(r);M.show(r.get("counter"));if(r._options.carousel){r._carousel.bindControls()}if(r._options.autoplay){r.pause();if(typeof r._options.autoplay==="number"){r._playtime=r._options.autoplay}r._playing=true}if(r._firstrun){if(r._options.autoplay){r.trigger(Galleria.PLAY)}if(typeof r._options.show==="number"){r.show(r._options.show)}return}r._firstrun=true;if(Galleria.History){Galleria.History.change(function(e){if(isNaN(e)){n.history.go(-1)}else{r.show(e,t,true)}})}r.trigger(Galleria.READY);Galleria.theme.init.call(r,r._options);e.each(Galleria.ready.callbacks,function(e,t){if(typeof t=="function"){t.call(r,r._options)}});r._options.extend.call(r,r._options);if(/^[0-9]{1,4}$/.test(h)&&Galleria.History){r.show(h,t,true)}else if(r._data[r._options.show]){r.show(r._options.show)}if(r._options.autoplay){r.trigger(Galleria.PLAY)}},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+r._stageWidth+"px, height: "+r._stageHeight+"px.",true)}})},load:function(t,n,r){var i=this,s=this._options;this._data=[];this._thumbnails=[];this.$("thumbnails").empty();if(typeof n==="function"){r=n;n=null}t=t||s.dataSource;n=n||s.dataSelector;r=r||s.dataConfig;if(/^function Object/.test(t.constructor)){t=[t]}if(t.constructor===Array){if(this.validate(t)){this._data=t}else{Galleria.raise("Load failed: JSON Array not valid.")}}else{n+=",.video,.iframe";e(t).find(n).each(function(t,n){n=e(n);var s={},o=n.parent(),u=o.attr("href"),a=o.attr("rel");if(u&&(n[0].nodeName=="IMG"||n.hasClass("video"))&&x(u)){s.video=u}else if(u&&n.hasClass("iframe")){s.iframe=u}else{s.image=s.big=u}if(a){s.big=a}e.each("big title description link layer".split(" "),function(e,t){if(n.data(t)){s[t]=n.data(t)}});i._data.push(e.extend({title:n.attr("title")||"",thumb:n.attr("src"),image:n.attr("src"),big:n.attr("src"),description:n.attr("alt")||"",link:n.attr("longdesc"),original:n.get(0)},s,r(n)))})}if(typeof s.dataSort=="function"){o.sort.call(this._data,s.dataSort)}else if(s.dataSort=="random"){this._data.sort(function(){return Math.round(Math.random())-.5})}if(this.getDataLength()){this._parseData().trigger(Galleria.DATA)}return this},_parseData:function(){var t=this,n;e.each(this._data,function(r,i){n=t._data[r];if("thumb"in i===false){n.thumb=i.image}if(!"big"in i){n.big=i.image}if("video"in i){var s=x(i.video);if(s){n.iframe=S[s.provider].embed(s.id)+function(){if(typeof t._options[s.provider]=="object"){var n="?",r=[];e.each(t._options[s.provider],function(e,t){r.push(e+"="+t)});if(s.provider=="youtube"){r=["wmode=opaque"].concat(r)}return n+r.join("&")}return""}();delete n.video;if(!("thumb"in n)||!n.thumb){n.thumb=s.provider+":"+s.id}}}});return this},destroy:function(){this.$("target").data("galleria",null);this.$("container").unbind("galleria");this.get("target").innerHTML=this._original.html;this.clearTimer();M.removeFromArray(C,this);M.removeFromArray(N,this);return this},splice:function(){var e=this,t=M.array(arguments);n.setTimeout(function(){o.splice.apply(e._data,t);e._parseData()._createThumbnails()},2);return e},push:function(){var e=this,t=M.array(arguments);if(t.length==1&&t[0].constructor==Array){t=t[0]}n.setTimeout(function(){o.push.apply(e._data,t);e._parseData()._createThumbnails(t)},2);return e},_getActive:function(){return this._controls.getActive()},validate:function(e){return true},bind:function(e,t){e=E(e);this.$("container").bind(e,this.proxy(t));return this},unbind:function(e){e=E(e);this.$("container").unbind(e);return this},trigger:function(t){t=typeof t==="object"?e.extend(t,{scope:this}):{type:E(t),scope:this};this.$("container").trigger(t);return this},addIdleState:function(e,t,n,r){this._idle.add.apply(this._idle,M.array(arguments));return this},removeIdleState:function(e){this._idle.remove.apply(this._idle,M.array(arguments));return this},enterIdleMode:function(){this._idle.hide();return this},exitIdleMode:function(){this._idle.showAll();return this},enterFullscreen:function(e){this._fullscreen.enter.apply(this,M.array(arguments));return this},exitFullscreen:function(e){this._fullscreen.exit.apply(this,M.array(arguments));return this},toggleFullscreen:function(e){this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,M.array(arguments));return this},bindTooltip:function(e,t){this._tooltip.bind.apply(this._tooltip,M.array(arguments));return this},defineTooltip:function(e,t){this._tooltip.define.apply(this._tooltip,M.array(arguments));return this},refreshTooltip:function(e){this._tooltip.show.apply(this._tooltip,M.array(arguments));return this},openLightbox:function(){this._lightbox.show.apply(this._lightbox,M.array(arguments));return this},closeLightbox:function(){this._lightbox.hide.apply(this._lightbox,M.array(arguments));return this},getActiveImage:function(){return this._getActive().image||t},getActiveThumb:function(){return this._thumbnails[this._active].image||t},getMousePosition:function(e){return{x:e.pageX-this.$("container").offset().left,y:e.pageY-this.$("container").offset().top}},addPan:function(t){if(this._options.imageCrop===false){return}t=e(t||this.getActiveImage());var n=this,r=t.width()/2,i=t.height()/2,s=parseInt(t.css("left"),10),o=parseInt(t.css("top"),10),u=s||0,a=o||0,f=0,l=0,c=false,h=M.timestamp(),p=0,d=0,m=function(e,n,r){if(e>0){d=Math.round(Math.max(e*-1,Math.min(0,n)));if(p!==d){p=d;if(v===8){t.parent()["scroll"+r](d*-1)}else{var i={};i[r.toLowerCase()]=d;t.css(i)}}}},g=function(e){if(M.timestamp()-h<50){return}c=true;r=n.getMousePosition(e).x;i=n.getMousePosition(e).y},y=function(e){if(!c){return}f=t.width()-n._stageWidth;l=t.height()-n._stageHeight;s=r/n._stageWidth*f*-1;o=i/n._stageHeight*l*-1;u+=(s-u)/n._options.imagePanSmoothness;a+=(o-a)/n._options.imagePanSmoothness;m(l,a,"Top");m(f,u,"Left")};if(v===8){t.parent().scrollTop(a*-1).scrollLeft(u*-1);t.css({top:0,left:0})}this.$("stage").unbind("mousemove",g).bind("mousemove",g);this.addTimer("pan"+n._id,y,50,true);return this},proxy:function(e,t){if(typeof e!=="function"){return p}t=t||this;return function(){return e.apply(t,M.array(arguments))}},removePan:function(){this.$("stage").unbind("mousemove");this.clearTimer("pan"+this._id);return this},addElement:function(t){var n=this._dom;e.each(M.array(arguments),function(e,t){n[t]=M.create("galleria-"+t)});return this},attachKeyboard:function(e){this._keyboard.attach.apply(this._keyboard,M.array(arguments));return this},detachKeyboard:function(){this._keyboard.detach.apply(this._keyboard,M.array(arguments));return this},appendChild:function(e,t){this.$(e).append(this.get(t)||t);return this},prependChild:function(e,t){this.$(e).prepend(this.get(t)||t);return this},remove:function(e){this.$(M.array(arguments).join(",")).remove();return this},append:function(e){var t,n;for(t in e){if(e.hasOwnProperty(t)){if(e[t].constructor===Array){for(n=0;e[t][n];n++){this.appendChild(t,e[t][n])}}else{this.appendChild(t,e[t])}}}return this},_scaleImage:function(t,n){t=t||this._controls.getActive();if(!t){return}var r=this,i,s=function(t){e(t.container).children(":first").css({top:Math.max(0,M.parseValue(t.image.style.top)),left:Math.max(0,M.parseValue(t.image.style.left)),width:M.parseValue(t.image.width),height:M.parseValue(t.image.height)})};n=e.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition,iframelimit:this._options.maxVideoSize},n);if(this._options.layerFollow&&this._options.imageCrop!==true){if(typeof n.complete=="function"){i=n.complete;n.complete=function(){i.call(t,t);s(t)}}else{n.complete=s}}else{e(t.container).children(":first").css({top:0,left:0})}t.scale(n);return this},updateCarousel:function(){this._carousel.update();return this},resize:function(n,r){if(typeof n=="function"){r=n;n=t}n=e.extend({width:0,height:0},n);var i=this,s=this.$("container");e.each(n,function(e,t){if(!t){s[e]("auto");n[e]=i._getWH()[e]}});e.each(n,function(e,t){s[e](t)});return this.rescale(r)},rescale:function(e,n,r){var i=this;if(typeof e==="function"){r=e;e=t}var s=function(){i._stageWidth=e||i.$("stage").width();i._stageHeight=n||i.$("stage").height();i._scaleImage();if(i._options.carousel){i.updateCarousel()}i.trigger(Galleria.RESCALE);if(typeof r==="function"){r.call(i)}};s.call(i);return this},refreshImage:function(){this._scaleImage();if(this._options.imagePan){this.addPan()}return this},show:function(e,t,n){if(this._queue.length>3||e===false||!this._options.queue&&this._queue.stalled){return}e=Math.max(0,Math.min(parseInt(e,10),this.getDataLength()-1));t=typeof t!=="undefined"?!!t:e<this.getIndex();n=n||false;if(!n&&Galleria.History){Galleria.History.set(e.toString());return}this._active=e;o.push.call(this._queue,{index:e,rewind:t});if(!this._queue.stalled){this._show()}return this},_show:function(){var r=this,i=this._queue[0],s=this.getData(i.index);if(!s){return}var u=s.iframe||(this.isFullscreen()&&"big"in s?s.big:s.image),a=this._controls.getActive(),f=this._controls.getNext(),l=f.isCached(u),c=this._thumbnails[i.index],h=function(){e(f.image).trigger("mouseup")};var p=function(t,i,s,u,a){return function(){var f;_.active=false;M.toggleQuality(i.image,r._options.imageQuality);r._layers[r._controls.active].innerHTML="";e(s.container).css({zIndex:0,opacity:0}).show();if(s.isIframe){e(s.container).find("iframe").remove()}r.$("container").toggleClass("iframe",!!t.iframe);e(i.container).css({zIndex:1,left:0,top:0}).show();r._controls.swap();if(r._options.imagePan){r.addPan(i.image)}if(t.link||r._options.lightbox||r._options.clicknext){e(i.image).css({cursor:"pointer"}).bind("mouseup",function(e){if(typeof e.which=="number"&&e.which>1){return}if(r._options.clicknext&&!Galleria.TOUCH){if(r._options.pauseOnInteraction){r.pause()}r.next();return}if(t.link){if(r._options.popupLinks){f=n.open(t.link,"_blank")}else{n.location.href=t.link}return}if(r._options.lightbox){r.openLightbox()}})}r._playCheck();r.trigger({type:Galleria.IMAGE,index:u.index,imageTarget:i.image,thumbTarget:a.image,galleriaData:t});o.shift.call(r._queue);r._queue.stalled=false;if(r._queue.length){r._show()}}}(s,f,a,i,c);if(this._options.carousel&&this._options.carouselFollow){this._carousel.follow(i.index)}if(this._options.preload){var d,v,m=this.getNext(),g;try{for(v=this._options.preload;v>0;v--){d=new Galleria.Picture;g=r.getData(m);d.preload(this.isFullscreen()&&"big"in g?g.big:g.image);m=r.getNext(m)}}catch(y){}}M.show(f.container);f.isIframe=!!s.iframe;e(r._thumbnails[i.index].container).addClass("active").siblings(".active").removeClass("active");r.trigger({type:Galleria.LOADSTART,cached:l,index:i.index,rewind:i.rewind,imageTarget:f.image,thumbTarget:c.image,galleriaData:s});r._queue.stalled=true;f.load(u,function(n){var o=e(r._layers[1-r._controls.active]).html(s.layer||"").hide();r._scaleImage(n,{complete:function(n){if("image"in a){M.toggleQuality(a.image,false)}M.toggleQuality(n.image,false);r.removePan();r.setInfo(i.index);r.setCounter(i.index);if(s.layer){o.show();if(s.link||r._options.lightbox||r._options.clicknext){o.css("cursor","pointer").unbind("mouseup").mouseup(h)}}var u=r._options.transition;e.each({initial:a.image===null,touch:Galleria.TOUCH,fullscreen:r.isFullscreen()},function(e,n){if(n&&r._options[e+"Transition"]!==t){u=r._options[e+"Transition"];return false}});if(u in _.effects===false){p()}else{var f={prev:a.container,next:n.container,rewind:i.rewind,speed:r._options.transitionSpeed||400};_.active=true;_.init.call(r,u,f,p)}r.trigger({type:Galleria.LOADFINISH,cached:l,index:i.index,rewind:i.rewind,imageTarget:n.image,thumbTarget:r._thumbnails[i.index].image,galleriaData:r.getData(i.index)})}})})},getNext:function(e){e=typeof e==="number"?e:this.getIndex();return e===this.getDataLength()-1?0:e+1},getPrev:function(e){e=typeof e==="number"?e:this.getIndex();return e===0?this.getDataLength()-1:e-1},next:function(){if(this.getDataLength()>1){this.show(this.getNext(),false)}return this},prev:function(){if(this.getDataLength()>1){this.show(this.getPrev(),true)}return this},get:function(e){return e in this._dom?this._dom[e]:null},getData:function(e){return e in this._data?this._data[e]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return typeof this._active==="number"?this._active:false},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(e){return typeof e==="undefined"?this._options:this._options[e]},setOptions:function(t,n){if(typeof t==="object"){e.extend(this._options,t)}else{this._options[t]=n}return this},play:function(e){this._playing=true;this._playtime=e||this._playtime;this._playCheck();this.trigger(Galleria.PLAY);return this},pause:function(){this._playing=false;this.trigger(Galleria.PAUSE);return this},playToggle:function(e){return this._playing?this.pause():this.play(e)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var e=this,t=0,n=20,r=M.timestamp(),i="play"+this._id;if(this._playing){this.clearTimer(i);var s=function(){t=M.timestamp()-r;if(t>=e._playtime&&e._playing){e.clearTimer(i);e.next();return}if(e._playing){e.trigger({type:Galleria.PROGRESS,percent:Math.ceil(t/e._playtime*100),seconds:Math.floor(t/1e3),milliseconds:t});e.addTimer(i,s,n)}};e.addTimer(i,s,n)}},setPlaytime:function(e){this._playtime=e;return this},setIndex:function(e){this._active=e;return this},setCounter:function(e){if(typeof e==="number"){e++}else if(typeof e==="undefined"){e=this.getIndex()+1}this.get("current").innerHTML=e;if(v){var t=this.$("counter"),n=t.css("opacity");if(parseInt(n,10)===1){M.removeAlpha(t[0])}else{this.$("counter").css("opacity",n)}}return this},setInfo:function(t){var n=this,r=this.getData(t);e.each(["title","description"],function(e,t){var i=n.$("info-"+t);if(!!r[t]){i[r[t].length?"show":"hide"]().html(r[t])}else{i.empty().hide()}});return this},hasInfo:function(e){var t="title description".split(" "),n;for(n=0;t[n];n++){if(!!this.getData(e)[t[n]]){return true}}return false},jQuery:function(t){var n=this,r=[];e.each(t.split(","),function(t,i){i=e.trim(i);if(n.get(i)){r.push(i)}});var i=e(n.get(r.shift()));e.each(r,function(e,t){i=i.add(n.get(t))});return i},$:function(e){return this.jQuery.apply(this,M.array(arguments))}};e.each(b,function(e,t){var n=/_/.test(t)?t.replace(/_/g,""):t;Galleria[t.toUpperCase()]="galleria."+n});e.extend(Galleria,{IE9:v===9,IE8:v===8,IE7:v===7,IE6:v===6,IE:v,WEBKIT:/webkit/.test(c),CHROME:/chrome/.test(c),SAFARI:/safari/.test(c)&&!/chrome/.test(c),QUIRK:v&&r.compatMode&&r.compatMode==="BackCompat",MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!n.opera,IPHONE:/iphone/.test(c),IPAD:/ipad/.test(c),ANDROID:/android/.test(c),TOUCH:"ontouchstart"in r});Galleria.addTheme=function(t){if(!t.name){Galleria.raise("No theme name specified")}if(typeof t.defaults!=="object"){t.defaults={}}else{t.defaults=w(t.defaults)}var r=false,i;if(typeof t.css==="string"){e("link").each(function(e,n){i=new RegExp(t.css);if(i.test(n.href)){r=true;O(t);return false}});if(!r){e("script").each(function(e,s){i=new RegExp("galleria\\."+t.name.toLowerCase()+"\\.");if(i.test(s.src)){r=s.src.replace(/[^\/]*$/,"")+t.css;n.setTimeout(function(){M.loadCSS(r,"galleria-theme",function(){O(t)})},1)}})}if(!r){Galleria.raise("No theme CSS loaded")}}else{O(t)}return t};Galleria.loadTheme=function(t,r){if(e("script").filter(function(){return e(this).attr("src")==t}).length){return}var i=false,s;e(n).load(function(){if(!i){s=n.setTimeout(function(){if(!i&&!Galleria.theme){Galleria.raise("Galleria had problems loading theme at "+t+". Please check theme path or load manually.",true)}},2e4)}});Galleria.unloadTheme();M.loadScript(t,function(){i=true;n.clearTimeout(s)});return Galleria};Galleria.unloadTheme=function(){if(typeof Galleria.theme=="object"){e("script").each(function(t,n){if((new RegExp("galleria\\."+Galleria.theme.name+"\\.")).test(n.src)){e(n).remove()}});Galleria.theme=t}return Galleria};Galleria.get=function(e){if(!!C[e]){return C[e]}else if(typeof e!=="number"){return C}else{Galleria.raise("Gallery index "+e+" not found")}};Galleria.configure=function(t,n){var r={};if(typeof t=="string"&&n){r[t]=n;t=r}else{e.extend(r,t)}Galleria.configure.options=r;e.each(Galleria.get(),function(e,t){t.setOptions(r)});return Galleria};Galleria.configure.options={};Galleria.on=function(t,n){if(!t){return}n=n||p;var r=t+n.toString().replace(/\s/g,"")+M.timestamp();e.each(Galleria.get(),function(e,i){i._binds.push(r);i.bind(t,n)});Galleria.on.binds.push({type:t,callback:n,hash:r});return Galleria};Galleria.on.binds=[];Galleria.run=function(t,n){if(e.isFunction(n)){n={extend:n}}e(t||"#galleria").galleria(n);return Galleria};Galleria.addTransition=function(e,t){_.effects[e]=t;return Galleria};Galleria.utils=M;Galleria.log=function(){var t=M.array(arguments);if("console"in n&&"log"in n.console){try{return n.console.log.apply(n.console,t)}catch(r){e.each(t,function(){n.console.log(this)})}}else{return n.alert(t.join("<br>"))}};Galleria.ready=function(t){if(typeof t!="function"){return Galleria}e.each(N,function(e,n){t.call(n,n._options)});Galleria.ready.callbacks.push(t);return Galleria};Galleria.ready.callbacks=[];Galleria.raise=function(t,n){var r=n?"Fatal error":"Error",i=this,s={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5},o=function(t){var i='<div style="padding:4px;margin:0 0 2px;background:#'+(n?"811":"222")+';">'+(n?"<strong>"+r+": </strong>":"")+t+"</div>";e.each(C,function(){var e=this.$("errors"),t=this.$("target");if(!e.length){t.css("position","relative");e=this.addElement("errors").appendChild("target","errors").$("errors").css(s)}e.append(i)});if(!C.length){e("<div>").css(e.extend(s,{position:"fixed"})).append(i).appendTo(m().body)}};if(a){o(t);if(n){throw new Error(r+": "+t)}}else if(n){if(k){return}k=true;n=false;o("Gallery could not load.")}};Galleria.version=u;Galleria.requires=function(e,t){t=t||"You need to upgrade Galleria to version "+e+" to use one or more components.";if(Galleria.version<e){Galleria.raise(t,true)}return Galleria};Galleria.Picture=function(t){this.id=t||null;this.image=null;this.container=M.create("galleria-image");e(this.container).css({overflow:"hidden",position:"relative"});this.original={width:0,height:0};this.ready=false;this.isIframe=false};Galleria.Picture.prototype={cache:{},show:function(){M.show(this.image)},hide:function(){M.moveOut(this.image)},clear:function(){this.image=null},isCached:function(e){return!!this.cache[e]},preload:function(t){e(new Image).load(function(e,t){return function(){t[e]=e}}(t,this.cache)).attr("src",t)},load:function(t,r,i){if(typeof r=="function"){i=r;r=null}if(this.isIframe){var s="if"+(new Date).getTime();this.image=e("<iframe>",{src:t,frameborder:0,id:s,allowfullscreen:true,css:{visibility:"hidden"}})[0];e(this.container).find("iframe,img").remove();this.container.appendChild(this.image);e("#"+s).load(function(t,r){return function(){n.setTimeout(function(){e(t.image).css("visibility","visible");if(typeof r=="function"){r.call(t,t)}},10)}}(this,i));return this.container}this.image=new Image;if(Galleria.IE8){e(this.image).css("filter","inherit")}var o=0,u=false,a=false,f=e(this.container),c=e(this.image),h=function(){if(!u){u=true;n.setTimeout(function(e,t){return function(){e.attr("src",t+"?"+M.timestamp())}}(e(this),t),50)}else{if(l){e(this).attr("src",l)}else{Galleria.raise("Image not found: "+t)}}},p=function(t,i,s){return function(){var o=function(){e(this).unbind("load");t.original=r||{height:this.height,width:this.width};t.container.appendChild(this);t.cache[s]=s;if(typeof i=="function"){n.setTimeout(function(){i.call(t,t)},1)}};if(!this.width||!this.height){n.setTimeout(function(t){return function(){if(t.width&&t.height){o.call(t)}else{if(!a){e(new Image).load(p).attr("src",t.src);a=true}else{Galleria.raise("Could not extract width/height from image: "+t.src+". Traced measures: width:"+t.width+"px, height: "+t.height+"px.")}}}}(this),2)}else{o.call(this)}}}(this,i,t);f.find("iframe,img").remove();c.css("display","block");M.hide(this.image);e.each("minWidth minHeight maxWidth maxHeight".split(" "),function(e,t){c.css(t,/min/.test(t)?"0":"none")});c.load(p).error(h).attr("src",t);return this.container},scale:function(n){var r=this;n=e.extend({width:0,height:0,min:t,max:t,margin:0,complete:p,position:"center",crop:false,canvas:false,iframelimit:t},n);if(this.isIframe){var i=n.width,s=n.height,o,u;if(n.iframelimit){var a=Math.min(n.iframelimit/i,n.iframelimit/s);if(a<1){o=i*a;u=s*a;e(this.image).css({top:s/2-u/2,left:i/2-o/2,position:"absolute"})}else{e(this.image).css({top:0,left:0})}}e(this.image).width(o||i).height(u||s).removeAttr("width").removeAttr("height");e(this.container).width(i).height(s);n.complete.call(r,r);try{if(this.image.contentWindow){e(this.image.contentWindow).trigger("resize")}}catch(f){}return this.container}if(!this.image){return this.container}var l,c,h=e(r.container),d;M.wait({until:function(){l=n.width||h.width()||M.parseValue(h.css("width"));c=n.height||h.height()||M.parseValue(h.css("height"));return l&&c},success:function(){var t=(l-n.margin*2)/r.original.width,i=(c-n.margin*2)/r.original.height,s=Math.min(t,i),o=Math.max(t,i),u={"true":o,width:t,height:i,"false":s,landscape:r.original.width>r.original.height?o:s,portrait:r.original.width<r.original.height?o:s},a=u[n.crop.toString()],f="";if(n.max){a=Math.min(n.max,a)}if(n.min){a=Math.max(n.min,a)}e.each(["width","height"],function(t,n){e(r.image)[n](r[n]=r.image[n]=Math.round(r.original[n]*a))});e(r.container).width(l).height(c);if(n.canvas&&L){L.elem.width=r.width;L.elem.height=r.height;f=r.image.src+":"+r.width+"x"+r.height;r.image.src=L.cache[f]||function(e){L.context.drawImage(r.image,0,0,r.original.width*a,r.original.height*a);try{d=L.elem.toDataURL();L.length+=d.length;L.cache[e]=d;return d}catch(t){return r.image.src}}(f)}var h={},p={},v=function(t,n,i){var s=0;if(/\%/.test(t)){var o=parseInt(t,10)/100,u=r.image[n]||e(r.image)[n]();s=Math.ceil(u*-1*o+i*o)}else{s=M.parseValue(t)}return s},m={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};e.each(n.position.toLowerCase().split(" "),function(e,t){if(t==="center"){t="50%"}h[e?"top":"left"]=t});e.each(h,function(t,n){if(m.hasOwnProperty(n)){e.extend(p,m[n])}});h=h.top?e.extend(h,p):p;h=e.extend({top:"50%",left:"50%"},h);e(r.image).css({position:"absolute",top:v(h.top,"height",c),left:v(h.left,"width",l)});r.show();r.ready=true;n.complete.call(r,r)},error:function(){Galleria.raise("Could not scale image: "+r.image.src)},timeout:1e3});return this}};e.extend(e.easing,{galleria:function(e,t,n,r,i){if((t/=i/2)<1){return r/2*t*t*t+n}return r/2*((t-=2)*t*t+2)+n},galleriaIn:function(e,t,n,r,i){return r*(t/=i)*t+n},galleriaOut:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n}});e.fn.galleria=function(t){var n=this.selector;if(!e(this).length){e(function(){if(e(n).length){e(n).galleria(t)}else{Galleria.utils.wait({until:function(){return e(n).length},success:function(){e(n).galleria(t)},error:function(){Galleria.raise('Init failed: Galleria could not find the element "'+n+'".')},timeout:5e3})}});return this}return this.each(function(){if(e.data(this,"galleria")){e.data(this,"galleria").destroy();e(this).find("*").hide()}e.data(this,"galleria",(new Galleria).init(this,t))})}})(jQuery);(function(e){Galleria.addTheme({name:"classic",author:"Galleria",css:"template.css",defaults:{transition:"slide",thumbCrop:"height",_toggleInfo:!0},init:function(t){Galleria.requires(1.28,"This version of Classic theme requires Galleria 1.2.8 or later"),this.addElement("info-link","info-close"),this.append({info:["info-link","info-close"]});var n=this.$("info-link,info-close,info-text"),r=Galleria.TOUCH,i=r?"touchstart":"click";this.$("loader,counter").show().css("opacity",.4),r||(this.addIdleState(this.get("image-nav-left"),{left:-50}),this.addIdleState(this.get("image-nav-right"),{right:-50}),this.addIdleState(this.get("counter"),{opacity:0})),t._toggleInfo===!0?n.bind(i,function(){n.toggle()}):(n.show(),this.$("info-link, info-close").hide()),this.bind("thumbnail",function(t){r?e(t.thumbTarget).css("opacity",this.getIndex()?1:.6):(e(t.thumbTarget).css("opacity",.6).parent().hover(function(){e(this).not(".active").children().stop().fadeTo(100,1)},function(){e(this).not(".active").children().stop().fadeTo(400,.6)}),t.index===this.getIndex()&&e(t.thumbTarget).css("opacity",1))}),this.bind("loadstart",function(t){t.cached||this.$("loader").show().fadeTo(200,.4),this.$("info").toggle(this.hasInfo()),e(t.thumbTarget).css("opacity",1).parent().siblings().children().css("opacity",.6)}),this.bind("loadfinish",function(e){this.$("loader").fadeOut(200)})}})})(jQuery);if(jQuery("#portfolio_galleria").length!=0){Galleria.ready(function(){var e=this;jQuery("#portfolio_galleria").click(function(t){if(t.target!="[object HTMLDivElement]")e.enterFullscreen()})});Galleria.run("#portfolio_galleria")}if(jQuery("#door_main_img").length!=0){Galleria.ready(function(){var e=this;jQuery("#door_main_img").click(function(t){if(t.target!="[object HTMLDivElement]")e.openLightbox()})});Galleria.run("#door_main_img")}this.screenshotPreview=function(){xOffset=10;yOffset=30;jQuery(".product_similar_link").hover(function(e){this.t=this.title;this.title="";var t=this.t!=""?"<br/>"+this.t:"";jQuery("body").append("<p id='product_preview'><img src='"+this.rel+"' alt='url preview'>"+t+"</p>");jQuery("#product_preview").css("top",e.pageY-xOffset+"px").css("left",e.pageX+yOffset+"px").fadeIn("fast")},function(){this.title=this.t;jQuery("#product_preview").remove()});jQuery(".product_similar_link").mousemove(function(e){jQuery("#product_preview").css("top",e.pageY-xOffset+"px").css("left",e.pageX+yOffset+"px")})};jQuery(document).ready(function(){screenshotPreview()});if(jQuery("#accessory_main_img").length!=0){Galleria.ready(function(){var e=this;jQuery("#accessory_main_img").click(function(t){if(t.target!="[object HTMLDivElement]")e.openLightbox()})});Galleria.run("#accessory_main_img")}if(jQuery("#antivibratic_main_img").length!=0){Galleria.ready(function(){var e=this;jQuery("#antivibratic_main_img").click(function(t){if(t.target!="[object HTMLDivElement]")e.openLightbox()})});Galleria.run("#antivibratic_main_img")}if(jQuery("#blanket_main_img").length!=0){Galleria.ready(function(){var e=this;jQuery("#blanket_main_img").click(function(t){if(t.target!="[object HTMLDivElement]")e.openLightbox()})});Galleria.run("#blanket_main_img")}if(jQuery("#panel_main_img").length!=0){Galleria.ready(function(){var e=this;jQuery("#panel_main_img").click(function(t){if(t.target!="[object HTMLDivElement]")e.openLightbox()})});Galleria.run("#panel_main_img")}if(jQuery("#acoustic_simulator_solution_gallery").length!=0){Galleria.ready(function(){var e=this;jQuery("#acoustic_simulator_solution_gallery").click(function(t){if(t.target!="[object HTMLDivElement]")e.openLightbox()})});Galleria.run("#acoustic_simulator_solution_gallery")}var panel_id=jQuery("#panel_graph_panel_id").text();var graph_63hz=jQuery("#panel_graph_63hz").text();var graph_80hz=jQuery("#panel_graph_80hz").text();var graph_100hz=jQuery("#panel_graph_100hz").text();var graph_125hz=jQuery("#panel_graph_125hz").text();var graph_160hz=jQuery("#panel_graph_160hz").text();var graph_200hz=jQuery("#panel_graph_200hz").text();var graph_250hz=jQuery("#panel_graph_250hz").text();var graph_315hz=jQuery("#panel_graph_315hz").text();var graph_400hz=jQuery("#panel_graph_400hz").text();var graph_500hz=jQuery("#panel_graph_500hz").text();var graph_630hz=jQuery("#panel_graph_630hz").text();var graph_800hz=jQuery("#panel_graph_800hz").text();var graph_1000hz=jQuery("#panel_graph_1000hz").text();var graph_1250hz=jQuery("#panel_graph_1250hz").text();var graph_1600hz=jQuery("#panel_graph_1600hz").text();var graph_2000hz=jQuery("#panel_graph_2000hz").text();var graph_2500hz=jQuery("#panel_graph_2500hz").text();var graph_3150hz=jQuery("#panel_graph_3150hz").text();var graph_4000hz=jQuery("#panel_graph_4000hz").text();var graph_5000hz=jQuery("#panel_graph_5000hz").text();jQuery.jqplot("chartdiv",[[graph_63hz,graph_80hz,graph_100hz,graph_125hz,graph_160hz,graph_200hz,graph_250hz,graph_315hz,graph_400hz,graph_500hz,graph_630hz,graph_800hz,graph_1000hz,graph_1250hz,graph_1600hz,graph_2000hz,graph_2500hz,graph_3150hz,graph_4000hz,graph_5000hz]],{stackseries:true,axes:{xaxis:{renderer:jQuery.jqplot.CategoryAxisRenderer,ticks:["63 Hz","80 Hz","100 Hz","125 Hz","160 Hz","200 Hz","250 Hz","315 Hz","400 Hz","500 Hz","630 Hz","800 Hz","1 kHz","1.25 kHz","1.6 kHz","2 kHz","2.5 kHz","3.15 kHz","4 kHz","5 kHz"],tickOptions:{fontSize:"8px",formatString:"%.2f"}},yaxis:{min:0,max:1.1,tickOptions:{fontSize:"8px",formatString:"%.2f"}}},seriesDefaults:{rendererOptions:{smooth:true,animation:{show:true}},showMarker:true,color:"#f89f28"},highlighter:{show:true,showLabel:true,tooltipAxes:"y"}});jqplotToImg("chartdiv");var newCanvas